<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿ƒç»“è§£å¼€è¯„ä¼°ç³»ç»Ÿ - æ‰¾å›å†…å¿ƒå¹³é™</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* ç®€åŒ–çš„CSSæ ·å¼ï¼Œç¡®ä¿ç³»ç»Ÿæ­£å¸¸è¿è¡Œ */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary-color: #2D6A6A;
            --primary-hover: #58A8A8;
            --primary-light: #E1F0F0;
            --bg-warm: #FCFBF8;
            --bg-surface: #FFFFFF;
            --text-primary: #333333;
            --text-secondary: #6B7280;
            --border-color: #E5E7EB;
            --success-color: #28A745;
            --warning-color: #FFC107;
            --error-color: #DC3545;
            --font-heading: 'Poppins', sans-serif;
            --font-body: 'Inter', sans-serif;
            --space-xs: 8px;
            --space-sm: 16px;
            --space-md: 24px;
            --space-lg: 32px;
            --space-xl: 48px;
            --space-xxl: 64px;
            --space-xxxl: 96px;
            --border-radius: 12px;
            --shadow-card: 0 4px 12px rgba(45, 106, 106, 0.08);
            --shadow-button: 0 2px 4px rgba(0, 0, 0, 0.1);
            --transition-smooth: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-quick: all 0.2s ease-in-out;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--bg-warm);
            color: var(--text-primary);
            line-height: 1.7;
            font-size: 16px;
            min-height: 100vh;
        }

        .page-container { display: none; min-height: 100vh; padding: var(--space-md); }
        .page-container.active { display: block; }

        .hero-section {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-xxxl) var(--space-md);
        }

        .hero-content {
            max-width: 768px;
            text-align: center;
        }

        .hero-title {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 48px;
            line-height: 1.2;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
        }

        .hero-subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            margin-bottom: var(--space-xl);
            line-height: 1.8;
        }

        .disclaimer {
            background-color: #FFFBEB;
            border: 1px solid #FED7AA;
            border-radius: var(--border-radius);
            padding: var(--space-md);
            margin: var(--space-xl) 0;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            text-align: left;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .test-info {
            display: flex;
            justify-content: center;
            gap: var(--space-xl);
            margin: var(--space-xl) 0;
            flex-wrap: wrap;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--text-secondary);
            font-size: 14px;
        }

        .cta-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: var(--space-md) var(--space-xl);
            font-size: 16px;
            font-weight: 500;
            font-family: var(--font-heading);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition-smooth);
            box-shadow: var(--shadow-button);
            min-width: 220px;
            min-height: 56px;
        }

        .cta-button:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(45, 106, 106, 0.2);
        }

        .test-container {
            max-width: 768px;
            margin: 0 auto;
            padding: var(--space-xl) 0;
        }

        .progress-section {
            margin-bottom: var(--space-xl);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: var(--primary-light);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: var(--space-sm);
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .progress-text {
            text-align: center;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .question-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-lg);
            box-shadow: var(--shadow-card);
            margin-bottom: var(--space-xl);
        }

        .question-header {
            margin-bottom: var(--space-lg);
        }

        .question-title {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            line-height: 1.3;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .dimension-tag {
            display: inline-block;
            background-color: var(--primary-light);
            color: var(--primary-color);
            padding: var(--space-xs) var(--space-sm);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .question-content {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: var(--space-lg);
            line-height: 1.6;
        }

        .question-options {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .option-item {
            background-color: var(--bg-warm);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: var(--space-md);
            cursor: pointer;
            transition: var(--transition-quick);
            position: relative;
        }

        .option-item:hover {
            border-color: var(--primary-light);
            background-color: var(--primary-light);
        }

        .option-item.selected {
            border-color: var(--primary-color);
            background-color: var(--primary-light);
            color: var(--primary-color);
        }

        .option-item input[type="radio"] {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        .option-label {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            cursor: pointer;
            font-size: 15px;
            line-height: 1.5;
        }

        .option-radio {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            position: relative;
            transition: var(--transition-quick);
        }

        .option-item.selected .option-radio {
            border-color: var(--primary-color);
        }

        .option-radio::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary-color);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .option-item.selected .option-radio::after {
            opacity: 1;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--space-md);
            margin-top: var(--space-xl);
        }

        .nav-button {
            padding: var(--space-md) var(--space-lg);
            font-size: 16px;
            font-weight: 500;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition-smooth);
            min-width: 120px;
            border: 2px solid transparent;
        }

        .nav-button.primary {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .nav-button.primary:hover:not(:disabled) {
            background-color: var(--primary-hover);
            border-color: var(--primary-hover);
        }

        .nav-button.secondary {
            background-color: transparent;
            color: var(--text-secondary);
            border-color: var(--border-color);
        }

        .nav-button.secondary:hover:not(:disabled) {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .result-container {
            max-width: 1024px;
            margin: 0 auto;
            padding: var(--space-xl) var(--space-md);
        }

        .result-header {
            text-align: center;
            margin-bottom: var(--space-xxxl);
        }

        .result-title {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 36px;
            line-height: 1.2;
            color: var(--text-primary);
            margin-bottom: var(--space-md);
        }

        .result-subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .summary-section {
            margin-bottom: var(--space-xxxl);
        }

        .summary-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-xl);
            box-shadow: var(--shadow-card);
            text-align: center;
        }

        .overall-score {
            margin: var(--space-lg) 0;
        }

        .score-number {
            font-family: var(--font-heading);
            font-weight: 700;
            font-size: 64px;
            color: var(--primary-color);
            line-height: 1;
            margin-bottom: var(--space-sm);
        }

        .score-label {
            font-size: 16px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .score-description {
            font-size: 16px;
            color: var(--text-secondary);
            line-height: 1.6;
            max-width: 600px;
            margin: 0 auto;
        }

        .chart-section {
            margin-bottom: var(--space-xxxl);
        }

        .chart-section h3 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
            text-align: center;
        }

        .chart-container {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-xl);
            box-shadow: var(--shadow-card);
            max-width: 600px;
            margin: 0 auto;
        }

        #trauma-radar-chart {
            max-height: 400px;
        }

        .priority-section {
            margin-bottom: var(--space-xxxl);
        }

        .priority-section h3 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
            text-align: center;
        }

        .priority-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-xl);
            box-shadow: var(--shadow-card);
            border-left: 4px solid var(--primary-color);
        }

        .priority-item {
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-lg);
            border-bottom: 1px solid var(--border-color);
        }

        .priority-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .priority-title {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 18px;
            color: var(--primary-color);
            margin-bottom: var(--space-sm);
        }

        .priority-score {
            display: inline-block;
            background-color: var(--primary-light);
            color: var(--primary-color);
            padding: var(--space-xs) var(--space-sm);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            margin-bottom: var(--space-sm);
        }

        .priority-impact {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 14px;
        }

        .details-section {
            margin-bottom: var(--space-xxxl);
        }

        .details-section h3 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--space-lg);
        }

        .detail-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-lg);
            box-shadow: var(--shadow-card);
        }

        .detail-card h4 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 18px;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .score-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-sm);
        }

        .score-badge {
            padding: var(--space-xs) var(--space-sm);
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .score-badge.low { background-color: #D1FAE5; color: #065F46; }
        .score-badge.medium { background-color: #FEF3C7; color: #92400E; }
        .score-badge.high { background-color: #FEE2E2; color: #991B1B; }
        .score-badge.severe { background-color: #FECACA; color: #7F1D1D; }

        .detail-card p {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 14px;
        }

        .recommendations-section {
            margin-bottom: var(--space-xxxl);
        }

        .recommendations-section h3 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
        }

        .recommendations-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-xl);
            box-shadow: var(--shadow-card);
        }

        .recommendation-item {
            padding: var(--space-md) 0;
            border-bottom: 1px solid var(--border-color);
        }

        .recommendation-item:last-child {
            border-bottom: none;
        }

        .recommendation-item h4 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 16px;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .recommendation-item p {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 14px;
        }

        .resources-section {
            margin-bottom: var(--space-xxxl);
        }

        .resources-section h3 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: var(--space-lg);
        }

        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-lg);
        }

        .resource-card {
            background-color: var(--bg-surface);
            border-radius: var(--border-radius);
            padding: var(--space-lg);
            box-shadow: var(--shadow-card);
            text-align: center;
        }

        .resource-card h4 {
            font-family: var(--font-heading);
            font-weight: 600;
            font-size: 16px;
            color: var(--text-primary);
            margin-bottom: var(--space-sm);
        }

        .resource-card p {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 14px;
            margin-bottom: var(--space-md);
        }

        .resource-card a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            padding: var(--space-sm) var(--space-md);
            border: 2px solid var(--primary-color);
            border-radius: var(--border-radius);
            transition: var(--transition-quick);
            display: inline-block;
        }

        .resource-card a:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .result-actions {
            text-align: center;
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            flex-wrap: wrap;
        }

        .action-button {
            padding: var(--space-md) var(--space-lg);
            font-size: 16px;
            font-weight: 500;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition-smooth);
            min-width: 180px;
            border: 2px solid transparent;
        }

        .action-button.primary {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .action-button.primary:hover {
            background-color: var(--primary-hover);
            border-color: var(--primary-hover);
        }

        .action-button.secondary {
            background-color: transparent;
            color: var(--text-secondary);
            border-color: var(--border-color);
        }

        .action-button.secondary:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 50vh;
            font-size: 18px;
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .hero-title { font-size: 32px; }
            .hero-subtitle { font-size: 16px; }
            .test-info { flex-direction: column; gap: var(--space-md); }
            .question-title { font-size: 20px; }
            .result-title { font-size: 28px; }
            .score-number { font-size: 48px; }
            .details-grid { grid-template-columns: 1fr; }
            .resources-grid { grid-template-columns: 1fr; }
            .result-actions { flex-direction: column; align-items: center; }
            .navigation { flex-direction: column; }
        }

        @media (max-width: 480px) {
            .page-container { padding: var(--space-sm); }
            .hero-section { padding: var(--space-xxl) var(--space-sm); }
            .hero-title { font-size: 28px; }
            .question-card { padding: var(--space-md); }
            .summary-card, .chart-container, .recommendations-card { padding: var(--space-lg); }
        }
    </style>
</head>
<body>
    <!-- é”™è¯¯æç¤ºåŒºåŸŸ -->
    <div id="error-message" style="display: none; position: fixed; top: 20px; right: 20px; background: #ff4444; color: white; padding: 15px; border-radius: 8px; z-index: 9999;"></div>

    <!-- æµ‹è¯•ä»‹ç»é¡µé¢ -->
    <div id="intro-page" class="page-container active">
        <div class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">å¿ƒç»“è§£å¼€è¯„ä¼°ç³»ç»Ÿ</h1>
                <p class="hero-subtitle">
                    æ¯ä¸ªäººå¿ƒä¸­éƒ½å¯èƒ½æœ‰ä¸€äº›è§£ä¸å¼€çš„å¿ƒç»“ï¼Œå®ƒä»¬å½±å“ç€æˆ‘ä»¬çš„æƒ…ç»ªã€å†³ç­–å’Œç”Ÿæ´»è´¨é‡ã€‚
                    é€šè¿‡è¿™ä¸ªè¯„ä¼°ç³»ç»Ÿï¼Œè¯†åˆ«æ‚¨éœ€è¦é‡ç‚¹è§£å¼€çš„å¿ƒç»“ï¼Œæ‰¾å›å†…å¿ƒçš„å¹³é™ã€‚
                </p>
                
                <div class="disclaimer">
                    <span>ğŸ’¡ æœ¬è¯„ä¼°ä»…ä¸ºè‡ªæˆ‘æ¢ç´¢å·¥å…·ï¼Œå¸®åŠ©æ‚¨æ›´å¥½åœ°äº†è§£è‡ªå·±çš„å†…å¿ƒä¸–ç•Œã€‚å¦‚éœ€è¦ï¼Œè¯·å¯»æ±‚ä¸“ä¸šå¿ƒç†å¥åº·æœåŠ¡ã€‚</span>
                </div>

                <div class="test-info">
                    <div class="info-item">
                        <span>â±ï¸ é¢„è®¡ç”¨æ—¶ï¼š15-20åˆ†é’Ÿ</span>
                    </div>
                    <div class="info-item">
                        <span>ğŸ”’ å®Œå…¨åŒ¿åä¿å¯†</span>
                    </div>
                </div>

                <button class="cta-button" onclick="startTest()">å¼€å§‹æ¢ç´¢</button>
            </div>
        </div>
    </div>

    <!-- æµ‹è¯•é¡µé¢ -->
    <div id="test-page" class="page-container">
        <div class="test-container">
            <div class="progress-section">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text">
                    <span id="current-question">1</span> / <span id="total-questions">28</span>
                </div>
            </div>

            <div class="question-card" id="question-card">
                <div class="question-header">
                    <h2 class="question-title" id="question-title"></h2>
                    <div class="dimension-tag" id="dimension-tag"></div>
                </div>
                <div class="question-content" id="question-content"></div>
                <div class="question-options" id="question-options"></div>
            </div>

            <div class="navigation">
                <button class="nav-button secondary" id="prev-btn" onclick="previousQuestion()" disabled>
                    ä¸Šä¸€é¢˜
                </button>
                <button class="nav-button primary" id="next-btn" onclick="nextQuestion()" disabled>
                    ä¸‹ä¸€é¢˜
                </button>
            </div>
        </div>
    </div>

    <!-- ç»“æœé¡µé¢ -->
    <div id="result-page" class="page-container">
        <div class="result-container">
            <div class="result-header">
                <h1 class="result-title">æ‚¨çš„å¿ƒç»“è§£å¼€æŠ¥å‘Š</h1>
                <p class="result-subtitle">é€šè¿‡æ·±å…¥åˆ†æï¼Œè¯†åˆ«æ‚¨éœ€è¦é‡ç‚¹è§£å¼€çš„å¿ƒç»“åŠå…¶å½±å“</p>
            </div>

            <div class="summary-section">
                <div class="summary-card">
                    <h3>æ€»ä½“è¯„ä¼°</h3>
                    <div class="overall-score">
                        <div class="score-number" id="overall-score">0</div>
                        <div class="score-label">å¿ƒç»“å›°æ‰°æŒ‡æ•°</div>
                    </div>
                    <div class="score-description" id="score-description"></div>
                </div>
            </div>

            <div class="chart-section">
                <h3>å„ç»´åº¦å¿ƒç»“åˆ†å¸ƒ</h3>
                <div class="chart-container">
                    <canvas id="trauma-radar-chart"></canvas>
                </div>
            </div>

            <div class="priority-section">
                <h3>é‡ç‚¹éœ€è¦è§£å¼€çš„å¿ƒç»“</h3>
                <div class="priority-card" id="priority-card">
                    <!-- åŠ¨æ€ç”Ÿæˆé‡ç‚¹å¿ƒç»“å†…å®¹ -->
                </div>
            </div>

            <div class="details-section">
                <h3>è¯¦ç»†åˆ†æ</h3>
                <div class="details-grid" id="details-grid">
                    <!-- åŠ¨æ€ç”Ÿæˆè¯¦ç»†å†…å®¹å¡ç‰‡ -->
                </div>
            </div>

            <div class="recommendations-section">
                <h3>å¿ƒç»“è§£å¼€å»ºè®®</h3>
                <div class="recommendations-card" id="recommendations-card">
                    <!-- åŠ¨æ€ç”Ÿæˆå»ºè®®å†…å®¹ -->
                </div>
            </div>

            <div class="resources-section">
                <h3>æ”¯æŒèµ„æº</h3>
                <div class="resources-grid">
                    <div class="resource-card">
                        <h4>å¿ƒç†å€¾å¬ä¸æˆé•¿æœåŠ¡</h4>
                        <p>ä¸“ä¸šçš„å¿ƒç†å€¾å¬å¸ˆä¸ºæ‚¨æä¾›æ¸©æš–çš„é™ªä¼´å’Œæˆé•¿æ”¯æŒ</p>
                        <a href="#" onclick="alert('å®é™…åº”ç”¨ä¸­å¯é“¾æ¥åˆ°ä¸“ä¸šå¿ƒç†å’¨è¯¢å¹³å°')">é¢„çº¦æœåŠ¡</a>
                    </div>
                    <div class="resource-card">
                        <h4>è§£å¼€å¿ƒç»“æ”¯æŒå°ç»„</h4>
                        <p>åŠ å…¥è§£å¼€å¿ƒç»“æ”¯æŒå°ç»„ï¼Œä¸æœ‰ç›¸ä¼¼ç»å†çš„äººåˆ†äº«ã€äº’ç›¸æ”¯æŒ</p>
                        <a href="#" onclick="alert('å®é™…åº”ç”¨ä¸­å¯é“¾æ¥åˆ°ç›¸å…³æ”¯æŒç¾¤ä½“ç½‘ç«™')">äº†è§£æ›´å¤š</a>
                    </div>
                </div>
            </div>

            <div class="result-actions">
                <button class="action-button primary" onclick="downloadReport()">
                    ä¸‹è½½å®Œæ•´æŠ¥å‘Š
                </button>
                <button class="action-button secondary" onclick="restartTest()">
                    é‡æ–°æµ‹è¯•
                </button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentQuestionIndex = 0;
        let answers = {};
        let testCompleted = false;
        let chartInstance = null;

        // DOM å…ƒç´ 
        const elements = {
            introPage: document.getElementById('intro-page'),
            testPage: document.getElementById('test-page'),
            resultPage: document.getElementById('result-page'),
            progressFill: document.getElementById('progress-fill'),
            currentQuestionSpan: document.getElementById('current-question'),
            totalQuestionsSpan: document.getElementById('total-questions'),
            questionTitle: document.getElementById('question-title'),
            questionContent: document.getElementById('question-content'),
            questionOptions: document.getElementById('question-options'),
            dimensionTag: document.getElementById('dimension-tag'),
            prevBtn: document.getElementById('prev-btn'),
            nextBtn: document.getElementById('next-btn'),
            overallScore: document.getElementById('overall-score'),
            scoreDescription: document.getElementById('score-description'),
            detailsGrid: document.getElementById('details-grid'),
            recommendationsCard: document.getElementById('recommendations-card'),
            priorityCard: document.getElementById('priority-card'),
            errorMessage: document.getElementById('error-message')
        };

        // å¿ƒç»“ç±»å‹æ•°æ®
        const traumaData = {
            dimensions: [
                {
                    id: 'relationship_break',
                    name: 'äº²å¯†å…³ç³»ç ´è£‚',
                    description: 'å…³äºæ‹çˆ±ã€å©šå§»å…³ç³»ä¸­çš„èƒŒå›ã€åˆ†ç¦»ç­‰åˆ›ä¼¤',
                    impact: {
                        'low': 'æ‚¨å¯¹äº²å¯†å…³ç³»ä¿æŒè¾ƒå¥½çš„ä¿¡ä»»åº¦å’Œå¼€æ”¾æ€§ï¼Œä½†å¶å°”ä¼šæœ‰ä¸€äº›æ‹…å¿§ã€‚',
                        'medium': 'äº²å¯†å…³ç³»ä¸­çš„ä¼¤å®³å½±å“äº†æ‚¨çš„ä¿¡ä»»æ„Ÿå’Œå®‰å…¨æ„Ÿï¼Œå¯èƒ½åœ¨å»ºç«‹æ–°å…³ç³»æ—¶å­˜åœ¨é¡¾è™‘ã€‚',
                        'high': 'äº²å¯†å…³ç³»ç ´è£‚ç»™æ‚¨é€ æˆäº†æ·±å±‚åˆ›ä¼¤ï¼Œå½±å“æ‚¨å¯¹çˆ±çš„è®¤çŸ¥å’Œå…³ç³»å»ºç«‹ã€‚',
                        'severe': 'äº²å¯†å…³ç³»çš„ç ´è£‚æ˜¯æ‚¨å¿ƒä¸­æœ€æ·±çš„ä¼¤ç—›ï¼Œä¸¥é‡å½±å“æ‚¨çš„ç”Ÿæ´»è´¨é‡å’Œå¿ƒç†å¥åº·ã€‚'
                    },
                    questions: [
                        { id: 1, text: 'æ‚¨æ˜¯å¦ç»å†è¿‡ä¼´ä¾£çš„èƒŒå›æˆ–æ¬ºéª—ï¼Œè®©æ‚¨å¯¹çˆ±æƒ…å¤±å»ä¿¡å¿ƒï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”æœ‰ç±»ä¼¼æƒ…å†µ'}, {value: 2, text: 'ç»å†è¿‡è¾ƒä¸¥é‡æƒ…å†µ'}, {value: 3, text: 'é€ æˆä¸¥é‡å¿ƒç†å½±å“'}] },
                        { id: 2, text: 'æ‚¨æ˜¯å¦å› ä¸ºåˆ†æ‰‹æˆ–ç¦»å©šè€Œé•¿æœŸæ„Ÿåˆ°ç—›è‹¦å’Œä¸èˆï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'éœ€è¦ä¸€äº›æ—¶é—´é€‚åº”'}, {value: 2, text: 'å¾ˆé•¿æ—¶é—´æ‰èƒ½æ¢å¤'}, {value: 3, text: 'åˆ°ç°åœ¨è¿˜ä¸èƒ½é‡Šæ€€'}] },
                        { id: 3, text: 'æ‚¨æ˜¯å¦å› ä¸ºä¼´ä¾£å‡ºè½¨èƒŒå›è€Œå¤±å»å¯¹çˆ±æƒ…çš„ä¿¡å¿ƒï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'ä¼šå°å¿ƒä¸€äº›'}, {value: 2, text: 'å¾ˆéš¾å†ç›¸ä¿¡'}, {value: 3, text: 'å®Œå…¨ä¸æ•¢ç›¸ä¿¡'}] },
                        { id: 4, text: 'æ‚¨æ˜¯å¦å› ä¸ºè¢«ä¼´ä¾£å¨èƒæˆ–æ§åˆ¶è€Œæ„Ÿåˆ°ææƒ§å’Œæ— åŠ©ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰ä¸€ç‚¹å½±å“'}, {value: 2, text: 'å½±å“æ¯”è¾ƒæ˜æ˜¾'}, {value: 3, text: 'å½±å“å¾ˆä¸¥é‡'}] }
                    ]
                },
                {
                    id: 'family_conflict',
                    name: 'äº²å­å…³ç³»å†²çª',
                    description: 'ä¸çˆ¶æ¯ã€å­å¥³ç­‰ç›´ç³»äº²å±çš„å…³ç³»é—®é¢˜',
                    impact: {
                        'low': 'æ‚¨ä¸å®¶åº­æˆå‘˜å…³ç³»ç›¸å¯¹å’Œè°ï¼Œèƒ½å¤Ÿæ­£å¸¸æ²Ÿé€šå’Œç›¸å¤„ã€‚',
                        'medium': 'äº²å­å…³ç³»ä¸­å­˜åœ¨ä¸€äº›æ²Ÿé€šéšœç¢æˆ–æƒ…æ„Ÿéš”é˜‚ï¼Œå½±å“å®¶åº­å’Œè°ã€‚',
                        'high': 'äº²å­å…³ç³»å†²çªç»™æ‚¨é€ æˆè¾ƒå¤§çš„æƒ…æ„Ÿå›°æ‰°ï¼Œå½±å“å®¶åº­æ°›å›´å’Œä¸ªäººæˆé•¿ã€‚',
                        'severe': 'äº²å­å…³ç³»çš„æ¶åŒ–æ˜¯æ‚¨å¿ƒä¸­æœ€æ·±çš„ç—›ï¼Œä¸¥é‡å½±å“æ‚¨çš„è‡ªæˆ‘è®¤çŸ¥å’Œæƒ…æ„Ÿå¥åº·ã€‚'
                    },
                    questions: [
                        { id: 5, text: 'æ‚¨æ˜¯å¦ç»å†è¿‡çˆ¶æ¯çš„æŠ›å¼ƒæˆ–è¢«æ‹éª—ç­‰ç«¥å¹´åˆ›ä¼¤äº‹ä»¶ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”ä¼šæœ‰å°çŸ›ç›¾'}, {value: 2, text: 'ç»å¸¸äº§ç”Ÿå†²çª'}, {value: 3, text: 'å…³ç³»å˜å¾—ç–è¿œ'}] },
                        { id: 6, text: 'æ‚¨æ˜¯å¦ç›®ç¹æˆ–ç»å†å®¶åº­æš´åŠ›äº‹ä»¶è€Œæ„Ÿåˆ°ææƒ§å’Œä¸å®‰ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰ä¸€äº›å½±å“'}, {value: 2, text: 'å½±å“å¾ˆæ˜æ˜¾'}, {value: 3, text: 'ç•™ä¸‹æ·±åˆ»åˆ›ä¼¤'}] },
                        { id: 7, text: 'æ‚¨æ˜¯å¦å› ä¸ºé­å—æ€§ä¾µæˆ–çŒ¥äºµè€Œç•™ä¸‹å¿ƒç†é˜´å½±ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”ä¼šæ‹…å¿ƒ'}, {value: 2, text: 'ç»å¸¸ä¸ºæ­¤ç„¦è™‘'}, {value: 3, text: 'æ„Ÿåˆ°ä¸¥é‡å›°æ‰°'}] },
                        { id: 8, text: 'æ‚¨æ˜¯å¦å› ä¸ºè¢«è¿«æ”¾å¼ƒå­¦ä¸šæˆ–æ¢¦æƒ³è€Œæ„Ÿåˆ°é—æ†¾å’Œç—›è‹¦ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰è½»å¾®å½±å“'}, {value: 2, text: 'å½±å“å¾ˆæ˜æ˜¾'}, {value: 3, text: 'ä¸¥é‡ç¼ºå¤±è¿™ç§æ„Ÿè§‰'}] }
                    ]
                },
                {
                    id: 'loss_grief',
                    name: 'é‡è¦äº²äººç¦»ä¸–',
                    description: 'å¤±å»è‡³äº²å¥½å‹å¸¦æ¥çš„å“€ä¼¤å’Œè‡ªè´£',
                    impact: {
                        'low': 'æ‚¨èƒ½å¤Ÿæ­£å¸¸å¤„ç†å¤±å»äº²äººçš„å“€ä¼¤ï¼Œè™½ç„¶ä¼šæƒ³å¿µä½†å·²æ¥å—ç°å®ã€‚',
                        'medium': 'é‡è¦äº²äººçš„ç¦»ä¸–ç»™æ‚¨å¸¦æ¥æŒç»­çš„æ‚²ä¼¤ï¼Œåœ¨æŸäº›æ—¶å€™ä¼šæ„Ÿåˆ°ç©ºè™šå’Œå­¤ç‹¬ã€‚',
                        'high': 'å¤±å»è‡³äº²ç»™æ‚¨é€ æˆæ·±å±‚åˆ›ä¼¤ï¼Œæ‚¨çš„æ—¥å¸¸ç”Ÿæ´»å—åˆ°æ˜æ˜¾å½±å“ã€‚',
                        'severe': 'äº²äººçš„ç¦»ä¸–æ˜¯æ‚¨å¿ƒä¸­æœ€å¤§çš„ç—›è‹¦ï¼Œè¿™ç§æŸå¤±æ„ŸæŒç»­å½±å“ç€æ‚¨çš„ç”Ÿæ´»ã€‚'
                    },
                    questions: [
                        { id: 9, text: 'æ‚¨æ˜¯å¦å› ä¸ºè‡³äº²ç¦»ä¸–è€Œé•¿æœŸæ„Ÿåˆ°ç©ºè™šå’Œå­¤ç‹¬ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”æ„Ÿåˆ°ç©ºè™š'}, {value: 2, text: 'ç»å¸¸æ„Ÿåˆ°å­¤ç‹¬'}, {value: 3, text: 'æŒç»­æ„Ÿåˆ°ç—›è‹¦'}] },
                        { id: 10, text: 'æ‚¨æ˜¯å¦å› ä¸ºè¢«è‡³äº²è‡³çˆ±æ¬ºç’è€Œæ„Ÿåˆ°è¢«èƒŒå›å’Œä¼¤å®³ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”ä¼šæœ‰è‡ªè´£'}, {value: 2, text: 'ç»å¸¸æ„Ÿåˆ°è‡ªè´£'}, {value: 3, text: 'ä¸€ç›´å¾ˆæ„§ç–š'}] },
                        { id: 11, text: 'æ‚¨æ˜¯å¦å› ä¸ºå® ç‰©æ­»äº¡è€Œé•¿æœŸå¤„äºå“€ä¼¤çŠ¶æ€ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰è½»å¾®å½±å“'}, {value: 2, text: 'å½±å“å¾ˆæ˜æ˜¾'}, {value: 3, text: 'å½±å“å¾ˆä¸¥é‡'}] },
                        { id: 12, text: 'æ‚¨æ˜¯å¦å› ä¸ºå› é”™è¿‡é‡è¦æœºä¼šè€Œæ„Ÿåˆ°æ·±æ·±é—æ†¾ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”ä¼šæƒ³èµ·'}, {value: 2, text: 'ç»å¸¸æƒ³èµ·'}, {value: 3, text: 'è¿˜æ˜¯éš¾ä»¥æ¥å—'}] }
                    ]
                },
                {
                    id: 'friendship_betrayal',
                    name: 'æœ‹å‹åç›®æˆä»‡',
                    description: 'å‹è°Šç ´è£‚ã€è¢«æœ‹å‹èƒŒå›çš„åˆ›ä¼¤ä½“éªŒ',
                    impact: {
                        'low': 'æ‚¨èƒ½å¤Ÿç†æ€§çœ‹å¾…å‹è°Šä¸­çš„é—®é¢˜ï¼Œå¯¹å»ºç«‹æ–°å‹è°Šä»ä¿æŒå¼€æ”¾æ€åº¦ã€‚',
                        'medium': 'å‹è°Šçš„ç ´è£‚å½±å“äº†æ‚¨å¯¹æœ‹å‹çš„ä¿¡ä»»ï¼Œåœ¨äº¤å‹æ—¶å˜å¾—æ›´åŠ è°¨æ…ã€‚',
                        'high': 'æœ‹å‹çš„èƒŒå›ç»™æ‚¨é€ æˆè¾ƒå¤§ä¼¤å®³ï¼Œæ‚¨å¯¹å‹è°Šäº§ç”Ÿäº†æ·±åº¦æ€€ç–‘ã€‚',
                        'severe': 'å‹è°Šçš„ç ´è£‚æ˜¯æ‚¨å¿ƒä¸­çš„é‡è¦åˆ›ä¼¤ï¼Œä¸¥é‡å½±å“äº†æ‚¨çš„ç¤¾äº¤èƒ½åŠ›å’Œä¿¡ä»»æ„Ÿã€‚'
                    },
                    questions: [
                        { id: 13, text: 'æ‚¨æ˜¯å¦å› ä¸ºä¸æœ‹å‹åç›®æˆä»‡è€Œæ„Ÿåˆ°è¢«æ·±æ·±èƒŒå›ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å—åˆ°ä¸€äº›ä¼¤å®³'}, {value: 2, text: 'å—åˆ°ä¸¥é‡ä¼¤å®³'}, {value: 3, text: 'ç•™ä¸‹æ·±åº¦ä¼¤å®³'}] },
                        { id: 14, text: 'æ‚¨æ˜¯å¦å› ä¸ºé­é‡æ ¡å›­éœ¸å‡Œè€Œå¯¹å­¦æ ¡ç”Ÿæ´»äº§ç”Ÿææƒ§ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'ä¼šå°å¿ƒä¸€äº›'}, {value: 2, text: 'å¾ˆéš¾å†ç›¸ä¿¡'}, {value: 3, text: 'å®Œå…¨ä¸æ•¢ç›¸ä¿¡'}] },
                        { id: 15, text: 'æ‚¨æ˜¯å¦å› ä¸ºè¢«å­¤ç«‹æ’æ–¥è€Œæ„Ÿåˆ°å­¤ç‹¬å’Œç—›è‹¦ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰è½»å¾®å½±å“'}, {value: 2, text: 'å½±å“å¾ˆæ˜æ˜¾'}, {value: 3, text: 'å½±å“å¾ˆä¸¥é‡'}] },
                        { id: 16, text: 'æ‚¨æ˜¯å¦å› ä¸ºè¢«ä¸å…¬å¹³å¯¹å¾…è€Œå¤±å»é‡è¦æœºä¼šæ„Ÿåˆ°æ„¤æ€’ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰ç‚¹æ‹…å¿ƒ'}, {value: 2, text: 'æ¯”è¾ƒæ‹…å¿ƒ'}, {value: 3, text: 'éå¸¸å®³æ€•'}] }
                    ]
                },
                {
                    id: 'major_failure',
                    name: 'é‡å¤§é€‰æ‹©å¤±è´¥',
                    description: 'åœ¨é‡è¦å†³ç­–ä¸Šçš„å¤±è¯¯å¸¦æ¥çš„æŒ«è´¥æ„Ÿ',
                    impact: {
                        'low': 'æ‚¨èƒ½å¤Ÿä»é‡å¤§é€‰æ‹©çš„å¤±è´¥ä¸­å­¦ä¹ ï¼Œå¯¹æœªæ¥çš„å†³ç­–ä»ä¿æŒä¿¡å¿ƒã€‚',
                        'medium': 'é‡è¦é€‰æ‹©çš„å¤±è´¥ç»™æ‚¨å¸¦æ¥æŒ«è´¥æ„Ÿï¼Œåœ¨åšå†³ç­–æ—¶å˜å¾—æ›´åŠ è°¨æ…ã€‚',
                        'high': 'é‡å¤§é€‰æ‹©çš„å¤±è¯¯ç»™æ‚¨é€ æˆè¾ƒå¤§æ‰“å‡»ï¼Œæ‚¨å¯¹é€‰æ‹©å’Œå†³ç­–å¤±å»ä¿¡å¿ƒã€‚',
                        'severe': 'å¤±è´¥çš„é€‰æ‹©æ˜¯æ‚¨å¿ƒä¸­çš„é‡æ‹…ï¼Œä¸¥é‡å½±å“äº†æ‚¨çš„è‡ªä¿¡å’Œå†³ç­–èƒ½åŠ›ã€‚'
                    },
                    questions: [
                        { id: 17, text: 'æ‚¨æ˜¯å¦å› ä¸ºé‡å¤§é€‰æ‹©å¤±è¯¯ï¼ˆå¦‚è‡ªä¼¤/è¾å­¦/æ‹©ä¸šç­‰ï¼‰è€Œåæ‚”ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”ä¼šåæ‚”'}, {value: 2, text: 'ç»å¸¸åæ‚”'}, {value: 3, text: 'ä¸€ç›´å¾ˆè‡ªè´£'}] },
                        { id: 18, text: 'æ‚¨æ˜¯å¦å› ä¸ºé‡å¤§è€ƒè¯•å¤±åˆ©è€Œæ”¹å˜äº†äººç”Ÿè½¨è¿¹ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰è½»å¾®å½±å“'}, {value: 2, text: 'å½±å“å¾ˆæ˜æ˜¾'}, {value: 3, text: 'æ„Ÿåˆ°ä¸¥é‡å›°æƒ‘'}] },
                        { id: 19, text: 'æ‚¨æ˜¯å¦å› ä¸ºæŠ•èµ„å¤±è´¥æˆ–è¢«éª—è€Œé­å—ç»æµæŸå¤±ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”é”™è¿‡æœºä¼š'}, {value: 2, text: 'é”™è¿‡äº†ä¸å°‘æœºä¼š'}, {value: 3, text: 'é”™è¿‡äº†é‡å¤§æœºä¼š'}] },
                        { id: 20, text: 'æ‚¨æ˜¯å¦å› ä¸ºè¢«è¿«åšè¿èƒŒè‰¯çŸ¥çš„äº‹æƒ…è€Œæ„Ÿåˆ°å†…ç–šï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰ç‚¹çŠ¹è±«'}, {value: 2, text: 'æ¯”è¾ƒçŠ¹è±«'}, {value: 3, text: 'æåº¦ææƒ§'}] }
                    ]
                },
                {
                    id: 'childhood_trauma',
                    name: 'ç«¥å¹´é˜´å½±åˆ›ä¼¤',
                    description: 'ç«¥å¹´æ—¶æœŸé­å—çš„å„ç§åˆ›ä¼¤å’Œä¸è‰¯ç»å†',
                    impact: {
                        'low': 'æ‚¨èƒ½å¤Ÿç†æ€§çœ‹å¾…ç«¥å¹´ç»å†ï¼Œè¿™äº›ç»å†æ²¡æœ‰å¯¹æ‚¨çš„æˆé•¿é€ æˆæ˜æ˜¾è´Ÿé¢å½±å“ã€‚',
                        'medium': 'ç«¥å¹´çš„ä¸€äº›é˜´å½±äº‹ä»¶å½±å“äº†æ‚¨çš„æ€§æ ¼å½¢æˆå’Œäººé™…å…³ç³»å»ºç«‹ã€‚',
                        'high': 'ç«¥å¹´åˆ›ä¼¤ç»™æ‚¨é€ æˆæ·±åˆ»å½±å“ï¼Œè‡³ä»Šä»å½±å“ç€æ‚¨çš„æƒ…ç»ªå’Œè¡Œä¸ºæ¨¡å¼ã€‚',
                        'severe': 'ç«¥å¹´é˜´å½±æ˜¯æ‚¨å¿ƒä¸­æœ€æ·±çš„ç—›ï¼Œè¿™äº›åˆ›ä¼¤æŒç»­å½±å“æ‚¨çš„ç”Ÿæ´»å’Œå¿ƒç†å¥åº·ã€‚'
                    },
                    questions: [
                        { id: 21, text: 'æ‚¨æ˜¯å¦å› ä¸ºå½“ä¼—è¢«ç¾è¾±æˆ–å˜²ç¬‘è€Œé•¿æœŸç¼ºä¹è‡ªä¿¡ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”ç¼ºä¹å®‰å…¨æ„Ÿ'}, {value: 2, text: 'ç»å¸¸ç¼ºä¹å®‰å…¨æ„Ÿ'}, {value: 3, text: 'ä¸¥é‡ç¼ºä¹å®‰å…¨æ„Ÿ'}] },
                        { id: 22, text: 'æ‚¨æ˜¯å¦å› ä¸ºè¢«å†¤æ‰æ— æ³•è‡ªè¯è€Œæ„Ÿåˆ°å§”å±ˆå’Œæ„¤æ€’ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰ç‚¹å›°éš¾'}, {value: 2, text: 'å›°éš¾å¾ˆæ˜æ˜¾'}, {value: 3, text: 'å¾ˆéš¾å»ºç«‹'}] },
                        { id: 23, text: 'æ‚¨æ˜¯å¦å› ä¸ºè¢«ä»–äººåˆ©ç”¨æˆ–æˆæœè¢«çªƒå–è€Œæ„Ÿåˆ°æ„¤æ€’ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”æœ‰ææƒ§æ„Ÿ'}, {value: 2, text: 'ç»å¸¸æœ‰ææƒ§æ„Ÿ'}, {value: 3, text: 'æŒç»­æœ‰ææƒ§æ„Ÿ'}] },
                        { id: 24, text: 'æ‚¨æ˜¯å¦å› ä¸ºèº«ä½“æ®‹ç¼ºè€Œæ— æ³•æ­£è§†è‡ªå·±æ„Ÿåˆ°ç—›è‹¦ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰ç‚¹åå·®'}, {value: 2, text: 'åå·®å¾ˆæ˜æ˜¾'}, {value: 3, text: 'ä¸¥é‡æ‰­æ›²è®¤çŸ¥'}] }
                    ]
                },
                {
                    id: 'public_humiliation',
                    name: 'å…¬å¼€å—è¾±ç»å†',
                    description: 'åœ¨å…¬ä¼—åœºåˆå—åˆ°ç¾è¾±ã€éœ¸å‡Œçš„åˆ›ä¼¤ä½“éªŒ',
                    impact: {
                        'low': 'æ‚¨èƒ½å¤Ÿä»å…¬å¼€å—è¾±çš„ç»å†ä¸­æ¢å¤ï¼Œå¯¹ç¤¾äº¤åœºåˆä»ä¿æŒæ­£å¸¸æ€åº¦ã€‚',
                        'medium': 'å…¬å¼€çš„ç¾è¾±ç»™æ‚¨å¸¦æ¥é˜´å½±ï¼Œåœ¨ç¤¾äº¤åœºåˆå˜å¾—æ›´åŠ è°¨æ…å’Œæ•æ„Ÿã€‚',
                        'high': 'å—è¾±ç»å†ç»™æ‚¨é€ æˆæ·±åˆ»åˆ›ä¼¤ï¼Œä¸¥é‡å½±å“äº†æ‚¨çš„è‡ªå°Šå¿ƒå’Œç¤¾äº¤èƒ½åŠ›ã€‚',
                        'severe': 'å…¬å¼€ç¾è¾±æ˜¯æ‚¨å¿ƒä¸­æœ€æ·±çš„ä¼¤å®³ï¼Œä¸¥é‡å½±å“äº†æ‚¨çš„è‡ªä¿¡å’Œç”Ÿæ´»è´¨é‡ã€‚'
                    },
                    questions: [
                        { id: 25, text: 'æ‚¨æ˜¯å¦å› ä¸ºè¡¨ç™½è¢«å˜²å¼„æ‹’ç»è€Œå¯¹æ„Ÿæƒ…äº§ç”Ÿææƒ§ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”ä¼šæœ‰å½±å“'}, {value: 2, text: 'ç»å¸¸æœ‰å½±å“'}, {value: 3, text: 'å½±å“å¾ˆä¸¥é‡'}] },
                        { id: 26, text: 'æ‚¨æ˜¯å¦å› ä¸ºåœ¨é‡è¦åœºåˆå‡ºä¸‘è€Œé•¿æœŸæ„Ÿåˆ°ç¾è€»ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰ç‚¹ç´§å¼ '}, {value: 2, text: 'æ¯”è¾ƒç´§å¼ '}, {value: 3, text: 'æåº¦ææƒ§'}] },
                        { id: 27, text: 'æ‚¨æ˜¯å¦å› ä¸ºè¢«PUAè€Œå¯¹è‡ªå·±çš„ä»·å€¼äº§ç”Ÿæ€€ç–‘ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'å¶å°”ä¼šé¿å…'}, {value: 2, text: 'ç»å¸¸é¿å…'}, {value: 3, text: 'å®Œå…¨é¿å…'}] },
                        { id: 28, text: 'æ‚¨æ˜¯å¦å› ä¸ºé‡å¤§è¿‡å¤±ï¼ˆå¦‚è½¦ç¥¸/è¿ç´¯ä»–äººï¼‰è€ŒæŒç»­è‡ªè´£ï¼Ÿ', options: [{value: 0, text: 'ä»æœªç»å†è¿‡'}, {value: 1, text: 'æœ‰è½»å¾®å½±å“'}, {value: 2, text: 'å½±å“å¾ˆæ˜æ˜¾'}, {value: 3, text: 'å½±å“å¾ˆä¸¥é‡'}] }
                    ]
                }
            ]
        };

        // é”™è¯¯å¤„ç†å‡½æ•°
        function showError(message) {
            console.error('Error:', message);
            elements.errorMessage.textContent = message;
            elements.errorMessage.style.display = 'block';
            setTimeout(() => {
                elements.errorMessage.style.display = 'none';
            }, 5000);
        }

        // è·å–æ‰€æœ‰é—®é¢˜
        function getAllQuestions() {
            const allQuestions = [];
            traumaData.dimensions.forEach(dimension => {
                dimension.questions.forEach(question => {
                    allQuestions.push({
                        ...question,
                        dimension: dimension.id,
                        dimensionName: dimension.name,
                        dimensionDescription: dimension.description,
                        impact: dimension.impact
                    });
                });
            });
            return allQuestions;
        }

        // åˆå§‹åŒ–æµ‹è¯•
        function initTest() {
            try {
                const allQuestions = getAllQuestions();
                elements.totalQuestionsSpan.textContent = allQuestions.length;
                currentQuestionIndex = 0;
                answers = {};
                testCompleted = false;
                console.log('Test initialized with', allQuestions.length, 'questions');
            } catch (error) {
                showError('åˆå§‹åŒ–æµ‹è¯•æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // å¼€å§‹æµ‹è¯•
        function startTest() {
            try {
                console.log('Starting test...');
                initTest();
                showPage('test');
                displayCurrentQuestion();
                updateProgress();
            } catch (error) {
                showError('å¼€å§‹æµ‹è¯•æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ˜¾ç¤ºé¡µé¢
        function showPage(pageName) {
            try {
                elements.introPage.classList.remove('active');
                elements.testPage.classList.remove('active');
                elements.resultPage.classList.remove('active');
                
                if (pageName === 'intro') {
                    elements.introPage.classList.add('active');
                } else if (pageName === 'test') {
                    elements.testPage.classList.add('active');
                } else if (pageName === 'result') {
                    elements.resultPage.classList.add('active');
                }
                console.log('Showing page:', pageName);
            } catch (error) {
                showError('åˆ‡æ¢é¡µé¢æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ˜¾ç¤ºå½“å‰é¢˜ç›®
        function displayCurrentQuestion() {
            try {
                const allQuestions = getAllQuestions();
                const question = allQuestions[currentQuestionIndex];
                
                if (!question) {
                    console.error('No question found for index:', currentQuestionIndex);
                    return;
                }
                
                console.log('Displaying question:', question.id, question.text);
                
                // æ›´æ–°é¢˜ç›®å†…å®¹
                elements.questionTitle.textContent = `é¢˜ç›® ${currentQuestionIndex + 1}`;
                elements.questionContent.textContent = question.text;
                elements.dimensionTag.textContent = question.dimensionName;
                
                // æ¸…ç©ºå¹¶åˆ›å»ºé€‰é¡¹
                elements.questionOptions.innerHTML = '';
                
                question.options.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option-item';
                    
                    if (answers[question.id] === option.value) {
                        optionDiv.classList.add('selected');
                    }
                    
                    optionDiv.innerHTML = `
                        <input type="radio" name="question_${question.id}" value="${option.value}" 
                               ${answers[question.id] === option.value ? 'checked' : ''}>
                        <label class="option-label">
                            <span class="option-radio"></span>
                            ${option.text}
                        </label>
                    `;
                    
                    optionDiv.addEventListener('click', () => {
                        selectOption(question.id, option.value);
                    });
                    
                    elements.questionOptions.appendChild(optionDiv);
                });
                
                updateNavigationButtons();
            } catch (error) {
                showError('æ˜¾ç¤ºé¢˜ç›®æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // é€‰æ‹©é€‰é¡¹
        function selectOption(questionId, value) {
            try {
                console.log('Selecting option:', questionId, value);
                answers[questionId] = value;
                
                // æ›´æ–°UI
                const optionDivs = elements.questionOptions.querySelectorAll('.option-item');
                optionDivs.forEach(div => div.classList.remove('selected'));
                
                const selectedDiv = Array.from(optionDivs).find(div => {
                    const input = div.querySelector('input[type="radio"]');
                    return input && parseInt(input.value) === value;
                });
                
                if (selectedDiv) {
                    selectedDiv.classList.add('selected');
                }
                
                updateNavigationButtons();
            } catch (error) {
                showError('é€‰æ‹©é€‰é¡¹æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ›´æ–°å¯¼èˆªæŒ‰é’®
        function updateNavigationButtons() {
            const allQuestions = getAllQuestions();
            
            // æ›´æ–°å‰ä¸€é¢˜æŒ‰é’®
            elements.prevBtn.disabled = currentQuestionIndex === 0;
            
            // æ›´æ–°ä¸‹ä¸€é¢˜æŒ‰é’®
            const currentQuestion = allQuestions[currentQuestionIndex];
            const hasAnswer = currentQuestion && answers[currentQuestion.id] !== undefined;
            
            if (currentQuestionIndex === allQuestions.length - 1) {
                elements.nextBtn.textContent = 'æŸ¥çœ‹ç»“æœ';
                elements.nextBtn.disabled = !hasAnswer;
            } else {
                elements.nextBtn.textContent = 'ä¸‹ä¸€é¢˜';
                elements.nextBtn.disabled = !hasAnswer;
            }
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const allQuestions = getAllQuestions();
            const progress = ((currentQuestionIndex) / allQuestions.length) * 100;
            elements.progressFill.style.width = progress + '%';
            elements.currentQuestionSpan.textContent = currentQuestionIndex + 1;
        }

        // ä¸Šä¸€é¢˜
        function previousQuestion() {
            try {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    displayCurrentQuestion();
                    updateProgress();
                }
            } catch (error) {
                showError('ä¸Šä¸€é¢˜æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ä¸‹ä¸€é¢˜
        function nextQuestion() {
            try {
                const allQuestions = getAllQuestions();
                
                if (currentQuestionIndex === allQuestions.length - 1) {
                    // æ˜¾ç¤ºç»“æœ
                    showResults();
                } else {
                    currentQuestionIndex++;
                    displayCurrentQuestion();
                    updateProgress();
                }
            } catch (error) {
                showError('ä¸‹ä¸€é¢˜æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ˜¾ç¤ºç»“æœ
        function showResults() {
            try {
                console.log('Showing results...');
                testCompleted = true;
                showPage('result');
                generateResults();
            } catch (error) {
                showError('æ˜¾ç¤ºç»“æœæ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ç”Ÿæˆç»“æœ
        function generateResults() {
            try {
                // è®¡ç®—å„ç»´åº¦å¾—åˆ†
                const dimensionScores = {};
                traumaData.dimensions.forEach(dimension => {
                    const dimensionAnswers = dimension.questions.map(q => answers[q.id] || 0);
                    const avgScore = dimensionAnswers.reduce((sum, score) => sum + score, 0) / dimensionAnswers.length;
                    dimensionScores[dimension.id] = avgScore;
                });
                
                // è®¡ç®—æ€»ä½“å¾—åˆ†
                const overallScore = Math.round(
                    Object.values(dimensionScores).reduce((sum, score) => sum + score, 0) / traumaData.dimensions.length * 20
                );
                
                // æ›´æ–°æ€»ä½“è¯„ä¼°
                elements.overallScore.textContent = overallScore;
                elements.scoreDescription.textContent = getOverallDescription(overallScore);
                
                // ç”Ÿæˆé›·è¾¾å›¾
                generateRadarChart(dimensionScores);
                
                // ç”Ÿæˆé‡ç‚¹å¿ƒç»“åˆ†æ
                generatePriorityAnalysis(dimensionScores);
                
                // ç”Ÿæˆè¯¦ç»†åˆ†æ
                generateDetails(dimensionScores);
                
                // ç”Ÿæˆå»ºè®®
                generateRecommendations(dimensionScores);
                
                console.log('Results generated successfully');
            } catch (error) {
                showError('ç”Ÿæˆç»“æœæ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // æ€»ä½“æè¿°
        function getOverallDescription(score) {
            if (score < 25) return 'æ‚¨çš„å¿ƒç»“å›°æ‰°æŒ‡æ•°è¾ƒä½ï¼Œè¯´æ˜æ‚¨åœ¨å¤§å¤šæ•°æ–¹é¢éƒ½èƒ½å¤Ÿä¿æŒå†…å¿ƒçš„å¹³é™ã€‚ä½†ä»æœ‰ä¸€äº›å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ã€‚';
            if (score < 50) return 'æ‚¨çš„å¿ƒç»“å›°æ‰°æŒ‡æ•°ä¸­ç­‰ï¼Œæœ‰ä¸€äº›å¿ƒç»“éœ€è¦æ‚¨çš„å…³æ³¨å’ŒåŒ–è§£ã€‚å»ºè®®æ‚¨å¯»æ‰¾åˆé€‚çš„æ–¹å¼æ¥å¤„ç†è¿™äº›å›°æ‰°ã€‚';
            if (score < 75) return 'æ‚¨çš„å¿ƒç»“å›°æ‰°æŒ‡æ•°è¾ƒé«˜ï¼Œæœ‰å‡ ä¸ªæ–¹é¢çš„å¿ƒç»“å¯¹æ‚¨äº§ç”Ÿäº†æ˜æ˜¾å½±å“ã€‚å»ºè®®æ‚¨å¯»æ±‚ä¸“ä¸šå¸®åŠ©æ¥è§£å¼€è¿™äº›å¿ƒç»“ã€‚';
            return 'æ‚¨çš„å¿ƒç»“å›°æ‰°æŒ‡æ•°å¾ˆé«˜ï¼Œè¿™äº›å¿ƒç»“ä¸¥é‡å½±å“æ‚¨çš„ç”Ÿæ´»è´¨é‡å’Œå¿ƒç†å¥åº·ã€‚å¼ºçƒˆå»ºè®®æ‚¨å¯»æ±‚ä¸“ä¸šçš„å¿ƒç†æ”¯æŒå’ŒæŒ‡å¯¼ã€‚';
        }

        // è·å–é£é™©ç­‰çº§
        function getRiskLevel(score) {
            if (score < 25) return { level: 'low', label: 'è½»åº¦å›°æ‰°', color: '#28A745' };
            if (score < 50) return { level: 'medium', label: 'ä¸­åº¦å›°æ‰°', color: '#FFC107' };
            if (score < 75) return { level: 'high', label: 'é«˜åº¦å›°æ‰°', color: '#DC3545' };
            return { level: 'severe', label: 'é‡åº¦å›°æ‰°', color: '#8B0000' };
        }

        // ç”Ÿæˆé›·è¾¾å›¾
        function generateRadarChart(dimensionScores) {
            try {
                const canvas = document.getElementById('trauma-radar-chart');
                if (!canvas) {
                    console.error('Chart canvas not found');
                    return;
                }
                
                // é”€æ¯ç°æœ‰å›¾è¡¨å®ä¾‹
                if (chartInstance) {
                    chartInstance.destroy();
                }
                
                const ctx = canvas.getContext('2d');
                const labels = traumaData.dimensions.map(d => d.name);
                const data = traumaData.dimensions.map(d => Math.round((dimensionScores[d.id] || 0) / 12 * 100));
                
                chartInstance = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'å¿ƒç»“å›°æ‰°æŒ‡æ•° (%)',
                            data: data,
                            backgroundColor: 'rgba(45, 106, 106, 0.1)',
                            borderColor: '#2D6A6A',
                            borderWidth: 2,
                            pointBackgroundColor: '#2D6A6A',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: '#2D6A6A'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                ticks: { stepSize: 20 }
                            }
                        },
                        plugins: {
                            legend: { display: true }
                        }
                    }
                });
                
                console.log('Radar chart generated successfully');
            } catch (error) {
                console.error('Error generating radar chart:', error);
                showError('ç”Ÿæˆå›¾è¡¨æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ç”Ÿæˆé‡ç‚¹å¿ƒç»“åˆ†æ
        function generatePriorityAnalysis(dimensionScores) {
            try {
                // æ‰¾å‡ºå¾—åˆ†æœ€é«˜çš„å‰3ä¸ªç»´åº¦
                const sortedDimensions = Object.entries(dimensionScores)
                    .map(([id, score]) => ({ id, score, dimension: traumaData.dimensions.find(d => d.id === id) }))
                    .sort((a, b) => b.score - a.score)
                    .slice(0, 3);

                let priorityHTML = '';
                
                if (sortedDimensions.length === 0) {
                    priorityHTML = '<p style="text-align: center; color: #6B7280;">æ‚¨çš„å¿ƒç»“å›°æ‰°æŒ‡æ•°è¾ƒä½ï¼Œå»ºè®®ä¿æŒè‰¯å¥½çš„å¿ƒç†å¥åº·çŠ¶æ€ã€‚</p>';
                } else {
                    sortedDimensions.forEach(item => {
                        const score = Math.round((item.score || 0) / 3 * 100);
                        const riskLevel = getRiskLevel(score);
                        const dimension = item.dimension;
                        
                        // è·å–å¯¹åº”çš„æè¿°
                        let impactDesc = '';
                        if (score < 25) {
                            impactDesc = dimension.impact.low;
                        } else if (score < 50) {
                            impactDesc = dimension.impact.medium;
                        } else if (score < 75) {
                            impactDesc = dimension.impact.high;
                        } else {
                            impactDesc = dimension.impact.severe;
                        }
                        
                        priorityHTML += `
                            <div class="priority-item">
                                <div class="priority-title">${dimension.name}</div>
                                <div class="priority-score">${riskLevel.label} - ${score}%</div>
                                <div class="priority-impact">${impactDesc}</div>
                            </div>
                        `;
                    });
                }
                
                elements.priorityCard.innerHTML = priorityHTML;
                console.log('Priority analysis generated successfully');
            } catch (error) {
                console.error('Error generating priority analysis:', error);
                showError('ç”Ÿæˆé‡ç‚¹åˆ†ææ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ç”Ÿæˆè¯¦ç»†åˆ†æ
        function generateDetails(dimensionScores) {
            try {
                elements.detailsGrid.innerHTML = '';
                
                traumaData.dimensions.forEach(dimension => {
                    const score = Math.round((dimensionScores[dimension.id] || 0) / 3 * 100);
                    const riskLevel = getRiskLevel(score);
                    
                    const detailCard = document.createElement('div');
                    detailCard.className = 'detail-card';
                    
                    // è·å–å¯¹åº”çš„æè¿°
                    let description = '';
                    if (score < 25) {
                        description = dimension.impact.low;
                    } else if (score < 50) {
                        description = dimension.impact.medium;
                    } else if (score < 75) {
                        description = dimension.impact.high;
                    } else {
                        description = dimension.impact.severe;
                    }
                    
                    detailCard.innerHTML = `
                        <h4>${dimension.name}</h4>
                        <div class="score-indicator">
                            <span class="score-badge ${riskLevel.level}">${riskLevel.label}</span>
                            <span>${score}%</span>
                        </div>
                        <p>${description}</p>
                    `;
                    
                    elements.detailsGrid.appendChild(detailCard);
                });
                
                console.log('Details generated successfully');
            } catch (error) {
                console.error('Error generating details:', error);
                showError('ç”Ÿæˆè¯¦ç»†åˆ†ææ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ç”Ÿæˆå»ºè®®
        function generateRecommendations(dimensionScores) {
            try {
                const highRiskDimensions = Object.entries(dimensionScores)
                    .filter(([id, score]) => (score / 3 * 100) >= 50)
                    .map(([id]) => id);
                
                let recommendations = '';
                
                if (highRiskDimensions.length === 0) {
                    recommendations = `
                        <div class="recommendation-item">
                            <h4>ä¿æŒå¿ƒç†å¥åº·</h4>
                            <p>ç»§ç»­ç»´æŠ¤è‰¯å¥½çš„ç”Ÿæ´»ä¹ æƒ¯ï¼ŒåŸ¹å…»ç§¯æçš„å¿ƒæ€ï¼Œä¿æŒç¤¾äº¤è”ç³»ã€‚å®šæœŸè¿›è¡Œè‡ªæˆ‘åæ€ï¼Œä¿æŒå†…å¿ƒçš„å¹³é™ã€‚</p>
                        </div>
                    `;
                } else if (highRiskDimensions.length <= 2) {
                    recommendations = `
                        <div class="recommendation-item">
                            <h4>å…³æ³¨é‡ç‚¹å¿ƒç»“</h4>
                            <p>æ ¹æ®è¯„ä¼°ç»“æœï¼Œæ‚¨éœ€è¦é‡ç‚¹å…³æ³¨ ${highRiskDimensions.length} ä¸ªæ–¹é¢çš„å¿ƒç»“ã€‚å»ºè®®æ‚¨å…ˆä»æœ€å›°æ‰°çš„ä¸€ä¸ªå¼€å§‹ï¼Œå¯»æ±‚ä¸“ä¸šå¿ƒç†æ”¯æŒã€‚</p>
                        </div>
                        <div class="recommendation-item">
                            <h4>å¾ªåºæ¸è¿›</h4>
                            <p>è§£å¼€å¿ƒç»“æ˜¯ä¸€ä¸ªæ¸è¿›çš„è¿‡ç¨‹ï¼Œä¸è¦æ€¥äºæ±‚æˆã€‚å¯ä»¥ä»ç®€å•çš„è‡ªæˆ‘è°ƒèŠ‚å¼€å§‹ï¼Œå¦‚å†™æ—¥è®°ã€å†¥æƒ³ç­‰ã€‚</p>
                        </div>
                    `;
                } else {
                    recommendations = `
                        <div class="recommendation-item">
                            <h4>å¯»æ±‚ä¸“ä¸šæ”¯æŒ</h4>
                            <p>æ‚¨çš„è¯„ä¼°æ˜¾ç¤ºå¤šä¸ªæ–¹é¢éƒ½å­˜åœ¨è¾ƒé«˜çš„å¿ƒç»“å›°æ‰°ï¼Œå¼ºçƒˆå»ºè®®æ‚¨å¯»æ±‚ä¸“ä¸šçš„å¿ƒç†å€¾å¬ä¸æˆé•¿æœåŠ¡ã€‚ä¸“ä¸šçš„å€¾å¬å¸ˆå¯ä»¥å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£å’Œå¤„ç†è¿™äº›å›°æ‰°ã€‚</p>
                        </div>
                        <div class="recommendation-item">
                            <h4>å»ºç«‹æ”¯æŒç³»ç»Ÿ</h4>
                            <p>å¯»æ‰¾å¯ä»¥ä¿¡ä»»çš„æœ‹å‹æˆ–å®¶äººåˆ†äº«æ‚¨çš„æ„Ÿå—ï¼ŒåŠ å…¥è§£å¼€å¿ƒç»“æ”¯æŒå°ç»„ï¼Œä¸æœ‰ç›¸ä¼¼ç»å†çš„äººäº’ç›¸æ”¯æŒã€‚</p>
                        </div>
                        <div class="recommendation-item">
                            <h4>è‡ªæˆ‘å…³çˆ±</h4>
                            <p>åœ¨å¯»æ±‚ä¸“ä¸šå¸®åŠ©çš„åŒæ—¶ï¼Œä¹Ÿè¦å­¦ä¼šè‡ªæˆ‘å…³çˆ±ã€‚ä¿æŒè§„å¾‹çš„ä½œæ¯ï¼Œè¿›è¡Œé€‚é‡çš„è¿åŠ¨ï¼Œç»ƒä¹ æ­£å¿µå†¥æƒ³ç­‰ã€‚</p>
                        </div>
                    `;
                }
                
                elements.recommendationsCard.innerHTML = recommendations;
                console.log('Recommendations generated successfully');
            } catch (error) {
                console.error('Error generating recommendations:', error);
                showError('ç”Ÿæˆå»ºè®®æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // ä¸‹è½½æŠ¥å‘Š
        function downloadReport() {
            try {
                // è®¡ç®—å„ç»´åº¦å¾—åˆ†ç”¨äºæŠ¥å‘Š
                const dimensionScores = {};
                traumaData.dimensions.forEach(dimension => {
                    const dimensionAnswers = dimension.questions.map(q => answers[q.id] || 0);
                    const avgScore = dimensionAnswers.reduce((sum, score) => sum + score, 0) / dimensionAnswers.length;
                    dimensionScores[dimension.id] = Math.round((avgScore / 3) * 100);
                });

                const reportData = {
                    timestamp: new Date().toISOString(),
                    answers: answers,
                    dimensionScores: dimensionScores,
                    completed: testCompleted,
                    reportTitle: 'å¿ƒç»“è§£å¼€è¯„ä¼°æŠ¥å‘Š'
                };
                
                const dataBlob = new Blob([JSON.stringify(reportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `å¿ƒç»“è§£å¼€è¯„ä¼°æŠ¥å‘Š_${new Date().toISOString().slice(0, 10)}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                alert('æŠ¥å‘Šå·²ä¸‹è½½ä¸ºJSONæ–‡ä»¶ã€‚å¦‚éœ€æ›´è¯¦ç»†çš„åˆ†æå’Œå»ºè®®ï¼Œå»ºè®®å’¨è¯¢ä¸“ä¸šå¿ƒç†å€¾å¬ä¸æˆé•¿æœåŠ¡ã€‚');
            } catch (error) {
                showError('ä¸‹è½½æŠ¥å‘Šæ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // é‡æ–°å¼€å§‹æµ‹è¯•
        function restartTest() {
            try {
                console.log('Restarting test...');
                initTest();
                showPage('intro');
            } catch (error) {
                showError('é‡æ–°å¼€å§‹æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        // é”®ç›˜å¯¼èˆª
        document.addEventListener('keydown', function(e) {
            if (elements.testPage.classList.contains('active')) {
                if (e.key === 'ArrowRight' || e.key === ' ') {
                    e.preventDefault();
                    if (!elements.nextBtn.disabled) nextQuestion();
                } else if (e.key === 'ArrowLeft') {
                    e.preventDefault();
                    if (!elements.prevBtn.disabled) previousQuestion();
                }
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log('DOM loaded, initializing application...');
                initTest();
                console.log('Application initialized successfully');
            } catch (error) {
                showError('åˆå§‹åŒ–åº”ç”¨æ—¶å‡ºé”™ï¼š' + error.message);
            }
        });

        // Chart.jsåŠ è½½æ£€æŸ¥
        window.addEventListener('load', function() {
            if (typeof Chart === 'undefined') {
                showError('å›¾è¡¨åº“åŠ è½½å¤±è´¥ï¼Œé›·è¾¾å›¾åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨');
            }
        });
    </script>
</body>
</html>